---
title: Enable vulnerability assessment on your Azure SQL databases
description: Learn how to enable SQL vulnerability assessment on Azure SQL Database, Azure SQL Managed Instance, and Azure Synapse Analytics.
author: dcurwin
ms.author: dacurwin
ms.reviewer: wiassaf, vanto, mathoma
ms.date: 05/18/2023
ms.service: defender-for-cloud
ms.topic: how-to
ms.custom: sqldbrb=3
tags: azure-synapse
---

# Enable vulnerability assessment on your Azure SQL databases

In this article, you'll learn how to enable [vulnerability assessment](sql-azure-vulnerability-assessment-overview.md) so you can find and remediate database vulnerabilities. We recommend that you enable vulnerability assessment using the express configuration so you aren't dependent on a storage account. You can also enable vulnerability assessment using the classic configuration.

When you enable the Defender for Azure SQL plan in Defender for Cloud, Defender for Cloud automatically enables Advanced Threat Protection and vulnerability assessment with the express configuration for all Azure SQL databases in the selected subscription.

- If you have Azure SQL databases with vulnerability assessment disabled, you can enable vulnerability assessment in the express or classic configuration.
- If you have Azure SQL databases with vulnerability assessment enabled in the classic configuration, you can enable the express configuration so that assessments don't require a storage account.

## Prerequisites

- Make sure that [Microsoft Defender for Azure SQL](defender-for-databases-introduction.md) is enabled so that you can run scans on your Azure SQL databases.
- Make sure you read and understand the [differences between the express and classic configuration](sql-azure-vulnerability-assessment-overview.md#whats-the-difference-between-the-express-and-classic-configuration).

## Enable vulnerability assessment

When you enable the Defender for Azure SQL plan in Defender for Cloud, Defender for Cloud automatically enables Advanced Threat Protection and vulnerability assessment with the express configuration for all Azure SQL databases in the selected subscription.

You can enable vulnerability assessment in two ways:
- [Express configuration](#express-configuration)
- [Classic configuration](#classic-configuration)

### Express configuration

**To enable vulnerability assessment without a storage account, using the express configuration**:

1. Sign in to the [Azure portal](https://portal.azure.com/).
1. Open the specific Azure SQL Database resource. 
1. Under the Security heading, select **Defender for Cloud**.
1. Enable the express configuration of vulnerability assessment:
   
   - **If vulnerability assessment is not configured**, select **Enable** in the notice that prompts you to enable the vulnerability assessment express configuration, and confirm the change.

      :::image type="content" source="media/sql-azure-vulnerability-assessment-enable/enable-express-vulnerability-assessment.png" alt-text="Screenshot of notice to enable the express vulnerability assessment configuration in the Defender for Cloud settings for a SQL server.":::

      You can also select **Configure** and then select **Enable** in the Microsoft Defender for SQL settings:

      :::image type="content" source="media/sql-azure-vulnerability-assessment-enable/enable-express-vulnerability-assessment-configure.png" alt-text="Screenshot of notice to enable the express vulnerability assessment configuration in the Microsoft Defender for SQL settings.":::

      Select **Enable** to use the vulnerability assessment express configuration.

   - **If vulnerability assessment is already configured**, select **Enable** in the notice that prompts you to switch to express configuration, and confirm the change.
     > [!IMPORTANT]
     > Baselines and scan history are not migrated.

      :::image type="content" source="media/sql-azure-vulnerability-assessment-enable/migrate-to-express-vulnerability-assessment.png" alt-text="Screenshot of notice to migrate from the classic to the express vulnerability assessment configuration in the Defender for Cloud settings for a SQL server.":::

      You can also select **Configure** and then select **Enable** in the Microsoft Defender for SQL settings:
 
      :::image type="content" source="media/sql-azure-vulnerability-assessment-enable/migrate-to-express-vulnerability-assessment-configure.png" alt-text="Screenshot of notice to migrate from the classic to the express vulnerability assessment configuration in the Microsoft Defender for SQL settings.":::

Now you can go to the [**SQL databases should have vulnerability findings resolved**](https://ms.portal.azure.com/#view/Microsoft_Azure_Security_AzureDefenderForData/SqlVaServersRecommendationDetailsBlade/assessmentKey/82e20e14-edc5-4373-bfc4-f13121257c37) recommendation to see the vulnerabilities found in your databases. You can also run on-demand vulnerability assessment scans to see the current findings.

> [!NOTE] 
> Each database is randomly assigned a scan time on a set day of the week.

#### Enable express vulnerability assessment at scale

If you have SQL resources that don't have Advanced Threat Protection and vulnerability assessment enabled, you can use the [SQL vulnerability assessment APIs](sql-azure-vulnerability-assessment-manage.md#manage-vulnerability-assessments-programmatically) to enable SQL vulnerability assessment with the express configuration at scale.

### Classic configuration

To enable vulnerability assessment with a storage account, use the classic configuration:

1. In the [Azure portal](https://portal.azure.com), open the specific resource in Azure SQL Database, SQL Managed Instance Database, or Azure Synapse.

1. Under the **Security** heading, select **Defender for Cloud**.

1. Select **Configure** on the link to open the Microsoft Defender for SQL settings pane for either the entire server or managed instance.

    :::image type="content" source="media/defender-for-sql-azure-vulnerability-assessment/opening-sql-configuration.png" alt-text="Screenshot of the Defender for SQL configuration.":::

1. In the **Server settings** page, enter the Microsoft Defender for SQL settings:

    :::image type="content" source="media/defender-for-sql-azure-vulnerability-assessment/sql-vulnerability-scan-settings.png" alt-text="Screenshot of configuring the SQL vulnerability assessment scans.":::

    1. Configure a storage account where your scan results for all databases on the server or managed instance will be stored. For information about storage accounts, see [About Azure storage accounts](../storage/common/storage-account-create.md).

    1. To configure vulnerability assessments to automatically run weekly scans to detect security misconfigurations, set **Periodic recurring scans** to **On**. The results are sent to the email addresses you provide in **Send scan reports to**. You can also send email notification to admins and subscription owners by enabling **Also send email notification to admins and subscription owners**.

       > [!NOTE] 
       > Each database is randomly assigned a scan time on a set day of the week. Email notifications are scheduled randomly per server on a set day of the week. The email notification report includes data from all recurring database scans that were executed during the preceding week (does not include on-demand scans).

---

## Next steps  

Learn more about:

- [Microsoft Defender for Azure SQL](defender-for-sql-introduction.md)
- [Data discovery and classification](/azure/azure-sql/database/data-discovery-and-classification-overview)
- [Storing scan results in a storage account behind firewalls and VNets](/azure/azure-sql/database/sql-database-vulnerability-assessment-storage)
